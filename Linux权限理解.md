# Linux权限理解

**文章目录**

1. [Linux权限的概念](#1.0)
   1. [su](#1.1)
   2. [sudo](#1.2)
2. [Linux权限管理](#2.0)
   1. [文件访问者的分类](#2.1)
   2. [文件类型](#2.2)
      1. [file](#2.2.1)
   3. [基础权限](#2.3)
   4. [权限表示](#2.4)
   5. [权限设置](#2.5)
      1. [chmod](#2.5.1)
      2. [chown](#2.5.2)
      3. [chgrp](#2.5.3)
      4. [umask](#2.5.4)
   6. [粘滞位](#2.6)

---

## 1.Linux权限的概念<p id="1.0"></p>

**权限**：在特定环境下，对资源或行为的控制和限制

在Linux系统中，**权限管理**是非常重要的，特别是在**多用户**环境中

> Linux系统中，用户分为**超级用户(root)**和**普通用户**

**超级用户**：可以在Linux系统中做任何事，不受限制

**普通用户**：在Linux系统中做事受限制

> * 超级用户的命令提示符是"#"
> * 普通用户的命令提示符是"$"

### 1.1su命令<p id="1.1"></p>

**语法**：su [选项] 用户名

**功能**：切换用户

**常见用法**：

| 用法          | 含义                                         |
| ------------- | -------------------------------------------- |
| su            | 切换成root，工作目录不变                     |
| su -          | 切换成root，工作目录变成root的主目录         |
| su - [用户名] | 切换成[用户名]，工作目录变成[用户名]的主目录 |

### 1.2sudo命令<p id="1.2"></p>

**语法**：sudo 命令

**功能**：以其他身份来执行命令，默认身份是root

> 在`/etc/sudoers`中设置了可执行`sudo`指令的用户
>
> 若未经其授权的用户企图使用该命令，则会发出警告的邮件给管理员
>
> 用户使用`sudo`时，必须先输入密码，之后有5分钟的有效期限，过期后需要重新输入密码	

## 2.Linux权限管理<p id="2.0"></p>

### 2.1文件访问者的分类(人)<p id="2.1"></p>

* 文件或目录的拥有者：u---user
* 文件或目录的所有者所在的组的用户：g---group
* 其他用户：o---other

### 2.2文件类型<p id="2.2"></p>

| 符号 | 类型                          |
| ---- | ----------------------------- |
| d    | 目录                          |
| -    | 普通文件                      |
| l    | 软连接(类似windows的快捷方式) |
| b    | 块设备文件(例如：硬盘，光驱)  |
| p    | 管道文件                      |
| c    | 字符设备文件(例如键盘，鼠标)  |
| s    | 套接口文件                    |

#### 2.2.1file命令<p id="2.2.1"></p>

**语法**：file [选项] 文件

**功能**：探测给定文件的类型

**常见选项**：

| 选项 | 含义                                                   |
| ---- | ------------------------------------------------------ |
| -c   | 详细显示**指令**执行过程，便于排错或分析程序执行的情形 |
| -z   | 尝试去解读压缩文件的内容                               |

> **命令**和**指令**的区别：
>
> 1. **命令**是人给计算机的高层指示，**指令**是计算机硬件执行的基本操作
> 2. 在执行**命令**时，计算机会将**命令**翻译成一系列的**指令**，然后执行这些**指令**以完成相应的任务
> 3. 它们的关系类似于**C语言**与**Unix**之间的关系

### 2.3基础权限(文件属性)<p id="2.3"></p>

| 符号        | 文件                                                   | 目录                                         |
| ----------- | ------------------------------------------------------ | -------------------------------------------- |
| r---read    | 读取文件内容的权限                                     | 浏览该目录信息的权限(使用ls查看目录里的文件) |
| w---write   | 修改文件内容的权限(想要删除文件需要**上级目录**的权限) | 创建/删除/移动目录内文件的权限               |
| x---execute | 执行文件的权限                                         | 进入目录的权限                               |

### 2.4权限表示<p id="2.4"></p>

1. 符号表示

   | 符号 | 含义   |
   | ---- | ------ |
   | r--  | 只读   |
   | -w-  | 只写   |
   | ---x | 只执行 |
   | ---  | 无权限 |

2. 8进制数值表示

   | 符号 | 八进制 | 二进制 |
   | ---- | ------ | ------ |
   | r--  | 4      | 100    |
   | -w-  | 2      | 010    |
   | --x  | 1      | 001    |

### 2.5权限设置<p id="2.5"></p>

#### 2.5.1chmod命令<p id="2.5.1"></p>

**语法**：chmod [参数] 权限 文件名

**功能**：用来变更文件或目录的权限

**适用对象**：root用户/文件的拥有者

**常用选项**：

| 选项 | 含义                                       |
| ---- | ------------------------------------------ |
| -R   | 对目录以及目录下的文件递归执行更改权限操作 |

**用户符号**：

| 符号 | 用户     |
| ---- | -------- |
| u    | 拥有者   |
| g    | 所属组   |
| o    | 其他用户 |
| a    | 所有用户 |

**权限符号**：

| 符号 | 含义                               |
| ---- | ---------------------------------- |
| +    | 向权限范围增加权限代号所表示的权限 |
| -    | 向权限范围减少权限代号所表示的权限 |
| =    | 向权限范围赋予权限代号所表示的权限 |

#### 2.5.2chown命令<p id="2.5.2"></p>

**语法**：chown [选项] 用户名 文件名

**功能**：变更文件或目录的所有者或所属组	

**适用对象**：root用户

**常见用法**：

| 用法                | 含义                    |
| ------------------- | ----------------------- |
| chown ddy test.txt  | 将文件的拥有者改成ddy   |
| chown :ddy test.txt | 将文件的所属组改成ddy组 |

 #### 2.5.3chgrp命令<p id="2.5.3"></p>

**语法**：chgrp [选项] 用户组名 文件名

**功能**：变更文件或目录的所属组

#### 2.5.4umask命令<p id="2.5.4"></p>

**语法**：umask 权限值

**功能**：显示或创建文件的权限掩码

> 新建文件默认权限=0666(- rw- rw- rw-)
>
> 新建目录默认权限=0777(- rwx rwx rwx)
>
> 但实际上用户所新建的文件或目录，看到的权限并不是上面的值，因为创建文件或目录的时候还会收到`umask`的影响
>
> 假设默认权限是`mask`，则实际创建出来的文件权限是：mask & ~umask

**说明**：将默认权限减去权限掩码，即可产生建立文件时的预设权限

> roor默认掩码值：0022
>
> 普通用户默认掩码值：0002

### 2.6粘滞位<p id="2.6"></p>

> 当多个用户拥有了**目录**的w权限，就可以对**目录**下的文件进行创建或删除，所以对于A创建的文件B也有权删除，但是仔细想想，这样合理吗？我创建的文件，你怎么能删除，因此引入了**粘滞位**

**作用群体**：目录或文件

> 这里只谈论**目录**的情况，粘滞位对文件的影响只在Linux的特定实现中才会生效

**用法**：

```bash
$ chmod +t 目录	#对目录添加粘滞位
$ ll
drwxrwxrwt ... 	#其他用户的权限位的执行权限被替换成t
```

**作用**：

1. **删除**：限制用户对其他用户的文件的删除权限
2. **创建**：允许**没有写入权限**的用户，可以在目录下创建文件
